$(document).ready(function(e){var t,a,d,i,n,o,s,l,r,h,c,p,u,m,g,v,y,x,w,f,T,k,S,C,P,R,M,b,F,G,A,E,L,_,B,I,j,U,K,N,O,Y,D,J,H,V,W,X,q,z,Q,Z,et,tt;N=xhrck,b=void 0,d="assets/button.png",r="assets/hero.png",c="assets/stain.png",n="assets/foam.png",i="assets/fly.png",a=800,t=400,s=8,l=8,h=!1,window.Game=this,e=this,U=800,S=400,G=snapValue(Math.min(U/a,S/t),.5),B=0,w=void 0,f=void 0,L=void 0,m=void 0,g=void 0,j=void 0,K=void 0,y=[],C=void 0,_=void 0,u=[],E=[],P=!1,e.width=U,e.height=S,e.scale=G,k=10,T=10,p=[],o=void 0,A=void 0,v=void 0,x=void 0,I=0,et=0,H=0,tt=60,q=0,z=0,Q=0,Z=0,X=0,Y=50,W=50,V=50,D=200,O=0,J=10,R=[],e.getStains=function(){return p},e.preloadResources=function(){e.loadImage(r),e.loadImage(c),e.loadImage(n),e.loadImage(i)},F=0,M=0,e.loadImage=function(t){var a;a=new Image,a.onload=e.onLoadedAsset,a.src=t,u[t]=a,++F},e.onLoadedAsset=function(){++M,M===F&&e.initLevel()},e.initLevel=function(t){return $.jCryption.authenticate(tokens,$.extend({},N).x,SITE_URL+"/rinso-advanced-foam/auth-pubkey",SITE_URL+"/rinso-advanced-foam/hand-shake",function(){var a,d;return t?!1:(d={action:"init",data:"asdasda"},a=$.jCryption.encrypt(JSON.stringify(d),$.extend({},N).x),$.ajax({url:SITE_URL+"rinso-advanced-foam/do_act",dataType:"json",type:"POST",data:$.extend({data:a},tokens),success:function(a){return t=JSON.parse($.jCryption.decrypt(a.data,$.extend({},N).x)),e.initGame(t)}}))},function(){return console.log("error auth")})},e.initGame=function(i){var p,P,M,F,E;L&&(v.removeAllChildren(),m.removeAllChildren(),j.removeAllChildren(),L.removeAllChildren()),w=void 0,f=void 0,L=void 0,m=void 0,g=void 0,j=void 0,K=void 0,o=void 0,A=void 0,v=void 0,x=void 0,y=[],h=!1,_=new Stats,_.domElement.style.position="absolute",_.domElement.style.right="0px",_.domElement.style.top="0px",Math.seed=parseFloat(i.seed)||1,Y=parseFloat(i.speed)||50,W=parseFloat(i.min)||50,V=parseFloat(i.max)||50,D=parseFloat(i.hs)||200,J=parseFloat(i.point)||10,tt=parseFloat(i.time)||10,k=parseFloat(i.fsr)||10,T=parseFloat(i.fsr)||10,q=parseFloat(i.cp)||0,X=parseFloat(i.ulp)||0,H=parseFloat(i.lvl)||0,b=getWidth()>getHeight()?"landscape":"portrait",u[r]=nearestNeighborScale(u[r],G),u[c]=nearestNeighborScale(u[c],G),u[n]=nearestNeighborScale(u[n],G),$("canvas").length>0&&$("canvas").remove(),$("body").append("<canvas>"),w=$("canvas")[0],"landscape"===b?(G=snapValue(Math.min(U/a,S/t),.5),w.width=U,w.height=S):(U=500,G=snapValue(Math.min(S/t,U/a),.5),w.width=S,w.height=U),L=new Stage(w),"landscape"===b?(m=e.createBgGrid(s,l,400,400),m.regX=-200):(m=e.createBgGrid(s,l,400,400),m.regY=-80),L.addChild(m),K=new Container,L.addChild(K),j=new Container,"landscape"!==b&&(F=new Graphics,F.beginFill("rgb(22,20,240)").r(0,0,S,.15*U),E=new Shape(F),j.addChild(E)),L.addChild(j),P={images:[d],frames:{width:60,height:20,count:2},animations:{locked:0,unlocked:1}};for(M in i.lvl_all_dts)p=new Text(i.lvl_all_dts[M],"14px Arial","#dce"),y[M]=new Button(P,"locked",function(){}),"landscape"===b?(y[M].sprite.x=.1*U,y[M].sprite.y=S/4+M*(y[M].sprite.spriteSheet._frameHeight+5)):(y[M].sprite.x=25+M*(y[M].sprite.spriteSheet._frameWidth+5),y[M].sprite.y=3),y[M].sprite.gotoAndPlay("locked"),y[M].text=p,p.x=y[M].sprite.x+7,p.y=y[M].sprite.y,j.addChild(y[M].sprite),j.addChild(y[M].text),i.lu>=M&&y[M].sprite.gotoAndPlay("unlocked");p=new Text("Pause","14px Arial","#dce"),x=new Button(P,"locked",function(e){return Ticker.setPaused(!Ticker.getPaused()),Ticker.getPaused()?(e.target.gotoAndPlay("unlocked"),x.text.text="Unpause"):(e.target.gotoAndPlay("locked"),x.text.text="Pause")}),"landscape"===b?(x.sprite.x=.7*U,x.sprite.y=.05*S):(x.sprite.x=.8*S,x.sprite.y=.16*U),x.text=p,x.text.x=x.sprite.x+5,x.text.y=x.sprite.y,x.sprite.gotoAndPlay("locked"),j.addChild(x.sprite),j.addChild(x.text),A=new Text(q+"/"+X,"20px Arial","#ff7700"),"landscape"===b?(A.x=.82*U,A.y=.3*S):(A.x=.4*S,A.y=.1*U),A.textBaseline="alphabetic",j.addChild(A),v||("landscape"===b?(v=new BoxTimer(10,150,"v","#f0f"),v.x=.85*U,v.y=.75*S,v.rotation=180):(v=new BoxTimer(10,150,"h","#f0f"),v.x=.6*S,v.y=.08*U),j.addChild(v)),console.log(v),v.SetPercentage(0),C=new Hero(u[r]),e.reset(),L.enableMouseOver(),Touch.isSupported()?(Touch.enable(L),L.addEventListener("stagemousedown",e.handleKeyDown),L.addEventListener("stagemousemove",e.handleKeyDown)):(Ticker.timingMode=Ticker.RAF,document.onkeydown=e.handleKeyDown,document.onkeyup=e.handleKeyUp,document.onmousedown=e.handleKeyDown,document.onmouseup=e.handleKeyUp),Ticker.setFPS(30),Ticker.removeEventListener("tick",e.tick),Ticker.addEventListener("tick",e.tick),window.onblur=function(){return R=[],Ticker.getPaused()||Ticker.setPaused(!Ticker.getPaused()),x.sprite.gotoAndPlay("unlocked"),x.text.text="Unpause"}},e.reset=function(){var t,a,d,i;if(p=[],e.lastStain=null,K.removeAllChildren(),d=void 0,i=S/(1.5*u[c].height)+2,t=0,a=S/1.25,d=1,"landscape"===b){for(;i>d;)t=(d-.5)*u[c].width*2+(Math.seededRandom()*u[c].width-u[c].width/2),a=(Math.seededRandom()*(500-u[c].width)+150)*G,e.addStain(a,-t),d++;t=u[n].height*G,a=(Math.seededRandom()*(500-u[c].width)+150)*G,e.addFoam(a,-t),C.x=U/2-C.image.width/2*G,C.y=.85*S*G,C.reset(D,150,650)}else{for(;i>d;)t=(d-.5)*u[c].width*2+(Math.seededRandom()*u[c].width-u[c].width/2),a=Math.seededRandom()*(500-u[c].width)*G,e.addStain(a,-t),d++;t=u[n].height*G,a=Math.seededRandom()*(500-u[c].width)*G,e.addFoam(a,-t),C.x=S/2-C.image.width/2*G,C.y=.85*U,C.reset(D,0,400)}I=C.x,K.addChild(C)},e.tick=function(t){var a,d,i,r,h,c,g;if(_.begin(),O+=t.delta/1e3*Y,m.y="landscape"===b?(O+50)%(S/l):(O+50)%(S/s),!Ticker.getPaused()){if(C.tick(t),Touch.isSupported()?R[0]&&(C.x>R[0]+5||C.x<R[0]-5)?C.x>R[0]?C.move(-1):C.x<R[0]&&C.move(1):C.move(0):R[37]||R[65]||R[39]||R[68]?((R[37]||R[65])&&C.move(-1),(R[39]||R[68])&&C.move(1)):C.move(0),a=void 0,g=void 0,r=void 0,et=Ticker.getTime(!0)/1e3,et>tt){for(Ticker.setPaused(!0),r=p.length,a=0,d=null;r>a;)g=p[a],g.y=-g.image.height,a++;h={action:"end_game",s:q,l:H},i=$.jCryption.encrypt(JSON.stringify(h),$.extend({},N).x),$.ajax({url:SITE_URL+"rinso-advanced-foam/do_act",dataType:"json",type:"POST",data:$.extend({data:i},tokens),success:function(t){var a;return a=JSON.parse($.jCryption.decrypt(t.data,$.extend({},N).x)),"stop"===a.message?(alert("udah buyar"),!1):(N={x:a.nk},Ticker.reset(),Ticker.setPaused(!0),e.initLevel(a),e.initGame(a),Ticker.setPaused(!1))}})}else v.SetPercentage(et/tt);for(r=p.length,a=0,d=null;r>a;)g=p[a],g.y+=t.delta/1e3*g.velocityY,d=calculateCollision(g,"y",[C]),d&&(q+=J,e.moveStainToEnd(g)),"landscape"===b?g.localToGlobal(g.image.height,0).y>S&&e.moveStainToEnd(g):g.localToGlobal(g.image.height,0).y>U&&e.moveStainToEnd(g),a++;et>T&&(o.y+=t.delta/1e3*g.velocityY,d=calculateCollision(o,"y",[C]),c=!1,c="landscape"===b?o.localToGlobal(o.image.height,0).y>S:o.localToGlobal(o.image.height,0).y>U,(d||c)&&(d&&C.grow(),T+=k,"landscape"===b?(o.x=(Math.seededRandom()*(500-o.image.width)+150)*G,o.y=-u[n].height*G):(o.x=Math.seededRandom()*(500-o.image.width)*G,o.y=.1*S-u[n].height*G))),A.text=q+"/"+X}L.update(),_.end()},e.createBgGrid=function(e,t,a,d){var i,n,o,s,l,r,h,c;for(o=new Container,o.snapToPixel=!0,s=a/e,n=d/t,h=new Graphics,h.beginFill(Graphics.getRGB(101,60,176)),h.drawRect(0,0,.03*s,n*(t+2)),c=void 0,i=-1;e+2>i;)c=new Shape(h),c.snapToPixel=!0,c.x=i*s,c.y=-n,o.addChild(c),i++;for(l=new Graphics,l.beginFill(Graphics.getRGB(101,60,176)),l.drawRect(0,0,s*(e+2),.03*n),r=void 0,i=-1;t+1>i;)r=new Shape(l),r.snapToPixel=!0,r.x=-1*s,r.y=i*n,o.addChild(r),i++;return o},e.lastStain=null,e.addStain=function(t,a){var d;t=Math.round(t),a=Math.round(a),d=new Bitmap(u[c]),d.x=t,d.y=a,d.velocityY=Math.seededRandom()*(W-V)+V,d.snapToPixel=!0,K.addChild(d),p.push(d),e.lastStain=d},e.addFoam=function(e,t){e=Math.round(e),t=Math.round(t),o=new Bitmap(u[n]),o.x=e,o.y=t,o.velocityY=Math.seededRandom()*(W-V)+V,o.snapToPixel=!0,K.addChild(o)},e.moveStainToEnd=function(t){t.velocityY=Math.seededRandom()*(W-V)+V,"landscape"===b?(t.y=e.lastStain.y-2*t.image.width- -1*(Math.seededRandom()*t.image.width*2-t.image.width),t.x=(Math.seededRandom()*(500-t.image.width)+150)*G):(t.y=e.lastStain.y-2*t.image.width- -1*(Math.seededRandom()*t.image.width*2-t.image.width),t.x=Math.seededRandom()*(500-t.image.width)*G),e.lastStain=t},e.handleKeyDown=function(e){Touch.isSupported()?R[0]=e.stageX:R[e.keyCode]=!0,P||(P=!0)},e.handleKeyUp=function(e){Touch.isSupported()?R=[]:delete R[e.keyCode]},e.preloadResources()});
//# sourceMappingURL=init.min.js.map